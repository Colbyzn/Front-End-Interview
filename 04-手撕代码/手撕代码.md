# Front-End-Interview::04-æ‰‹æ’•ä»£ç 

## æ‰‹å†™æ·±æ‹·è´

<!-- notecardId: 1702310914312 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **åˆ¤æ–­è¦æ‹·è´çš„å¯¹è±¡ç±»å‹**ï¼šè‹¥ä¸ºå€¼ç±»å‹æˆ–è€…å‡½æ•°ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å€¼
2. **å£°æ˜å˜é‡**ï¼šç”¨äºå­˜å‚¨æ‰€æ‹·è´å¯¹è±¡
3. **å¤„ç†æ•°ç»„**ï¼šè‹¥ä¸ºæ•°ç»„ï¼Œåˆ™åˆå§‹åŒ–å˜é‡ä¸º []ï¼Œç„¶åéå†æ•°ç»„ï¼Œå¯¹æ•°ç»„å†…çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ deepClone å‡½æ•°ï¼ˆå³**é€’å½’è°ƒç”¨**ï¼‰
4. **å¤„ç†å¯¹è±¡**ï¼šè‹¥ä¸ºå¯¹è±¡ï¼Œåˆ™åˆå§‹åŒ–å˜é‡ä¸º {}ï¼Œç„¶åéå†å¯¹è±¡ï¼Œå¯¹å¯¹è±¡å†…çš„æ¯ä¸ª**è‡ªæœ‰å±æ€§**ï¼ˆå³éåŸå‹ä¸Šçš„å±æ€§ï¼‰è°ƒç”¨ deepClone å‡½æ•°ï¼ˆå³**é€’å½’è°ƒç”¨**ï¼‰
5. **è¿”å›ç»“æœ**

ä»£ç ï¼š

```javascript
function deepclone(obj) {
  if (typeof obj !== 'object' || obj == null) return obj;

  let result;

  if (obj instanceof Array) {
    result = [];
    for (let i = 0, len = obj.length; i < len; i++) {
      result[i] = deepclone(obj[i]);
    }
  }

  if (obj instanceof Object) {
    result = {};
    for (let key in obj) {
      if (obj.hasOwnProperty(key)) {
        result[key] = deepclone(obj[key]);
      }
    }
  }

  return result;
}
```

## æ‰‹å†™ call å‡½æ•°

<!-- notecardId: 1702742490459 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myCall æ–¹æ³•**
   > æ³¨ï¼šè¿™æ ·æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™å–å€¼ä¸º Window å¯¹è±¡
3. **è·å–å‰©ä½™å‚æ•°**ï¼ˆé™¤äº†ç¬¬ä¸€é¡¹ä¹‹å¤–çš„å‚æ•°ï¼‰
4. **å°†è°ƒç”¨ myCall æ–¹æ³•çš„å‡½æ•°ï¼ˆå³ thisï¼‰æ·»åŠ åˆ°æ‰€ä¼ å…¥çš„ this å¯¹è±¡çš„ fn å±æ€§ä¸Š**
5. **ä½¿ç”¨æ‰€ä¼ å…¥çš„ this å¯¹è±¡æ¥è°ƒç”¨ fn å‡½æ•°**ï¼Œå¹¶ä¼ å…¥å‰©ä½™å‚æ•°
   > æ³¨ï¼šè¿™æ ·å‡½æ•° fn ä¸­çš„ this å°±ä¼šæŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œå³æ‰€ä¼ å…¥çš„ this å¯¹è±¡
6. **åˆ é™¤æ–°æ·»åŠ çš„ fn å±æ€§**
   > æ³¨ï¼šé¿å…æ±¡æŸ“æ‰€ä¼ å…¥çš„ this å¯¹è±¡
7. **è¿”å›**å‡½æ•°è°ƒç”¨åçš„ç»“æœ

ä»£ç ï¼š

```javascript
Function.prototype.myCall = function (context) {
  context = context || window;

  const args = [...arguments].slice(1);

  context.fn = this;

  const result = context.fn(...args);

  delete context.fn;

  return result;
};
```

> æ³¨ï¼šå½“**å®å‚ä¸ªæ•°å¤šäºå½¢å‚**æ—¶ï¼Œå½¢å‚ context **åªä¼šè·å–æ‰€ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå®å‚**ï¼Œå…¶ä½™çš„å®å‚ä¼šå¿½ç•¥

## æ‰‹å†™ apply å‡½æ•°

<!-- notecardId: 1702742490463 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myApply æ–¹æ³•**
   > æ³¨ï¼šè¿™æ ·æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**å’Œ**å‚æ•°æ•°ç»„**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™ this å¯¹è±¡ä¸º Window å¯¹è±¡ï¼Œå‚æ•°æ•°ç»„ä¸º []
3. **å°†è°ƒç”¨ myApply æ–¹æ³•çš„å‡½æ•°ï¼ˆå³ thisï¼‰æ·»åŠ åˆ°æ‰€ä¼ å…¥çš„ this å¯¹è±¡çš„ fn å±æ€§ä¸Š**
4. **ä½¿ç”¨æ‰€ä¼ å…¥çš„ this å¯¹è±¡æ¥è°ƒç”¨ fn å‡½æ•°**ï¼Œå¹¶ä¼ å…¥å‰©ä½™å‚æ•°
   > æ³¨ï¼šè¿™æ ·å‡½æ•° fn ä¸­çš„ this å°±ä¼šæŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œå³æ‰€ä¼ å…¥çš„ this å¯¹è±¡
5. **åˆ é™¤æ–°æ·»åŠ çš„ fn å±æ€§**
   > æ³¨ï¼šé¿å…æ±¡æŸ“æ‰€ä¼ å…¥çš„ this å¯¹è±¡
6. **è¿”å›**å‡½æ•°è°ƒç”¨åçš„ç»“æœ

ä»£ç ï¼š

```javascript
Function.prototype.myApply = function (context, argsArr) {
  context = context || window;
  argsArr = argsArr || [];

  context.fn = this;

  const result = context.fn(...argsArr);

  delete context.fn;

  return result;
};
```

## æ‰‹å†™ bind å‡½æ•°

<!-- notecardId: 1702742490467 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myBind æ–¹æ³•**
   > æ³¨ï¼šä»¥ä¾¿æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™å–å€¼ä¸º Window å¯¹è±¡
3. **è·å–å‰©ä½™å‚æ•°**ï¼ˆé™¤äº†ç¬¬ä¸€é¡¹ä¹‹å¤–çš„å‚æ•°ï¼‰
4. **è·å–è°ƒç”¨ myBind æ–¹æ³•çš„å‡½æ•°**
5. **è¿”å›ä¸€ä¸ªæ–°å‡½æ•°**ï¼Œ åœ¨æ–°å‡½æ•°å†…ï¼š
   - å°†æ‰€ä¼ å…¥çš„ this å¯¹è±¡å’Œå‚æ•°**äº¤ç»™ apply å‡½æ•°æ¥å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†åçš„ç»“æœ**

```javascript
Function.prototype.myBind = function (context) {
  context = context || window;

  const argsArr = [...arguments].slice(1);

  const _this = this;

  return function () {
    return _this.apply(context, argsArr);
  };
};
```

## æ‰‹å†™ Promise åŠ è½½ä¸€å¼ å›¾ç‰‡

<!-- notecardId: 1702829254286 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å®šä¹‰ä¸€ä¸ªæ¥å— url å‚æ•°çš„ loadImage å‡½æ•°ï¼Œå¹¶**è¿”å›ä¸€ä¸ªæ–°çš„ Promise**
2. åœ¨è¿”å›çš„ Promise ä¸­ï¼Œ**åˆ›å»ºä¸€ä¸ª img å…ƒç´ **
3. ä¸º img å…ƒç´ **ç»‘å®š onload äº‹ä»¶**ï¼Œå½“å›¾ç‰‡åŠ è½½æˆåŠŸæ—¶ï¼Œè°ƒç”¨ resolve å‡½æ•°å¹¶ä¼ å…¥ img å…ƒç´ 
4. ä¸º img å…ƒç´ **ç»‘å®š onerror äº‹ä»¶**ï¼Œå½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œè°ƒç”¨ reject å‡½æ•°å¹¶ä¼ å…¥ä¸€ä¸ªåŒ…å«é”™è¯¯æç¤ºçš„ Error å¯¹è±¡
5. å°†ä¼ å…¥çš„ url **èµ‹å€¼**ç»™ img å…ƒç´  src å±æ€§
6. è°ƒç”¨ loadImage å‡½æ•°å¹¶ä¼ å…¥å›¾ç‰‡çš„ url è¿”å› Promise å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„ then æ–¹æ³•æ¥å¤„ç†æˆåŠŸçš„æƒ…å†µï¼Œcatch æ–¹æ³•æ¥å¤„ç†é”™è¯¯çš„æƒ…å†µ

ä»£ç ï¼š

```javascript
function loadImage(url) {
  return new Promise((resolve, reject) => {
    const img = document.createElement('img');

    img.onload = function () {
      resolve(img);
    };

    img.onerror = function () {
      reject(new Error(`å›¾ç‰‡åŠ è½½å¤±è´¥ ${url}`));
    };

    img.src = url;
  });
}

const url =
  'https://foruda.gitee.com/avatar/1677103757503685327/7933519_colbyzn_1597326220.png!avatar200';
loadImage(url)
  .then((img) => {
    document.body.appendChild(img);
  })
  .catch((error) => {
    console.log(error);
  });
```

## æ‰‹å†™ Promise

<!-- notecardId: 1703175555593 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **ä½¿ç”¨ class å£°æ˜ä¸€ä¸ªåä¸º MyPromise çš„ç±»**
2. åœ¨ç±»ä¸­
   - å®šä¹‰çŠ¶æ€ç®¡ç†çš„ç›¸å…³å±æ€§ï¼Œåˆ†åˆ«æ˜¯ **stateã€valueã€reasonã€onFulfilledCallbackã€onRejectedCallback**
     > æ³¨ï¼š
     > state â†’ å­˜å‚¨å½“å‰ Promise çŠ¶æ€å€¼
     > value â†’ å­˜å‚¨ Promise æˆåŠŸçŠ¶æ€çš„ç»“æœå€¼
     > reason â†’ å­˜å‚¨ Promise å¤±è´¥çŠ¶æ€çš„ç»“æœå€¼
     > onFulfilledCallback â†’ æ•°ç»„ï¼Œå­˜å‚¨ Promise æˆåŠŸçŠ¶æ€ä¸‹è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°
     > onRejectedCallback â†’ æ•°ç»„ï¼Œå­˜å‚¨ Promise å¤±è´¥çŠ¶æ€ä¸‹è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°
3. åœ¨æ„é€ å‡½æ•° constructor å†…ï¼š
   1. **æ¥å—ä¸€ä¸ªå‡½æ•° fn ä½œä¸ºå‚æ•°**
   2. **åœ¨ try catch ä¸­è°ƒç”¨ fn**ï¼ŒåŒæ—¶ä¼ å…¥ä¸¤ä¸ªå‡½æ•°å‚æ•° resolve å’Œ reject
   3. å£°æ˜å‡½æ•° resolveï¼Œåœ¨è¯¥å‡½æ•°å†…ï¼š
      - å½“çŠ¶æ€å€¼ä¸º pending æ—¶ï¼Œä¿®æ”¹çŠ¶æ€å€¼ä¸º fulfilledã€ä¿®æ”¹ç»“æœå€¼ä¸ºæ‰€ä¼ å…¥çš„å€¼ï¼Œä»¥åŠæ‰§è¡Œæ‰€æœ‰æˆåŠŸå›è°ƒå‡½æ•°
   4. å£°æ˜å‡½æ•° rejectï¼Œåœ¨è¯¥å‡½æ•°å†…ï¼š
      - å½“çŠ¶æ€å€¼ä¸º pending æ—¶ï¼Œä¿®æ”¹çŠ¶æ€å€¼ä¸º rejectedã€ä¿®æ”¹ç»“æœå€¼ä¸ºæ‰€ä¼ å…¥çš„å€¼ï¼Œä»¥åŠæ‰§è¡Œæ‰€æœ‰å¤±è´¥å›è°ƒå‡½æ•°
4. å£°æ˜ä¸€ä¸ªå…¬æœ‰æ–¹æ³• thenï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
   1. æ¥å—ä¸¤ä¸ªå¯é€‰å‚æ•° onFulfilled å’Œ onRejected
   2. åˆ¤æ–­ä¸¤ä¸ªå‚æ•°æ˜¯å¦ä¸ºå‡½æ•°ç±»å‹ï¼Œ**è‹¥ä¸æ˜¯ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å‡½æ•°æ›¿æ¢**
   3. è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡å†…ï¼š
      1. **è‹¥çŠ¶æ€å€¼ä¸º fulfilled**ï¼Œåˆ™åœ¨ try catch ä¸­è°ƒç”¨ onFulfilled å‡½æ•°ï¼Œå¹¶ä¼ å…¥å½“å‰ Promise æˆåŠŸçŠ¶æ€çš„ç»“æœå€¼ï¼Œä»¥è·å–è¿”å›å€¼ï¼Œç„¶åè°ƒç”¨ resolve å‡½æ•°ï¼Œå¹¶å°†è¿”å›å€¼ä¼ å…¥ï¼Œä»è€Œä¿®æ”¹æ‰€è¿”å›æ–° Promise å¯¹è±¡çš„çŠ¶æ€å€¼å’Œç»“æœå€¼
      2. **è‹¥çŠ¶æ€å€¼ä¸º rejected**ï¼Œåˆ™åœ¨ try catch ä¸­è°ƒç”¨ onRejectedï¼Œå¹¶ä¼ å…¥å½“å‰ Promise å¤±è´¥çŠ¶æ€çš„ç»“æœå€¼ï¼Œä»¥è·å–è¿”å›å€¼ï¼Œç„¶åè°ƒç”¨ reject å‡½æ•°ï¼Œå¹¶å°†è¿”å›å€¼ä¼ å…¥ï¼Œä»è€Œä¿®æ”¹æ‰€è¿”å›æ–° Promise å¯¹è±¡çš„çŠ¶æ€å€¼å’Œç»“æœå€¼
      3. **è‹¥çŠ¶æ€å€¼ä¸º pending**ï¼Œåˆ™å°†çŠ¶æ€å€¼ä¸º fulfilled å’Œ rejected æ‰€å¯¹åº”çš„æ‰§è¡Œä»£ç åŒ…è£¹åœ¨å‡½æ•°å†…ï¼Œå¹¶æ·»åŠ åˆ°ç›¸åº”çš„å›è°ƒæ•°ç»„ä¸­ï¼Œç­‰å¾…æ‰§è¡Œ
         > æ³¨ï¼šä¸Šè¿°çš„çŠ¶æ€å€¼æŒ‡çš„æ˜¯**è°ƒç”¨ then æ–¹æ³•çš„ Promise å¯¹è±¡çš„çŠ¶æ€å€¼**
5. å®šä¹‰ä¸€ä¸ªå…¬æœ‰æ–¹æ³• catchï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
   1. æ¥å—ä¸€ä¸ªå‚æ•° onRejected
   2. å°†æ‰€ä¼ å…¥çš„å‚æ•° onRejected **äº¤ç»™ then æ–¹æ³•å¤„ç†**ï¼Œå¹¶è¿”å›å¤„ç†åçš„ç»“æœ

ä»£ç ï¼š

```javascript
class MyPromise {
  // å…¬æœ‰å±æ€§
  state = 'pending';
  value = undefined;
  reason = undefined;
  onFulfilledCallback = [];
  onRejectedCallback = [];

  // æ„é€ å‡½æ•°
  constructor(fn) {
    const resolve = (value) => {
      if (this.state === 'pending') {
        this.state = 'fulfilled';
        this.value = value;
        this.onFulfilledCallback.forEach((fn) => fn());
      }
    };

    const reject = (reason) => {
      if (this.state === 'pending') {
        this.state = 'rejected';
        this.reason = reason;
        this.onRejectedCallback.forEach((fn) => fn());
      }
    };

    try {
      fn(resolve, reject);
    } catch (error) {
      reject(error);
    }
  }

  // then æ–¹æ³•
  then(onFulfilled, onRejected) {
    onFulfilled =
      typeof onFulfilled === 'function' ? onFulfilled : (value) => value;
    onRejected =
      typeof onRejected === 'function' ? onRejected : (reason) => reason;

    return new MyPromise((resolve, reject) => {
      if (this.state === 'fulfilled') {
        try {
          const newValue = onFulfilled(this.value);
          resolve(newValue);
        } catch (error) {
          reject(error);
        }
      }
      if (this.state === 'rejected') {
        try {
          const newReason = onRejected(this.reason);
          reject(newReason);
        } catch (error) {
          reject(error);
        }
      }
      if (this.state === 'pending') {
        this.onFulfilledCallback.push(() => {
          try {
            const newValue = onFulfilled(this.value);
            resolve(newValue);
          } catch (error) {
            reject(error);
          }
        });
        this.onRejectedCallback.push(() => {
          try {
            const newReason = onRejected(this.reason);
            resolve(newReason);
          } catch (error) {
            reject(error);
          }
        });
      }
    });
  }

  // catch æ–¹æ³•
  catch(onRejected) {
    return this.then(null, onRejected);
  }
}
```

## æ‰‹å†™ Promise.resolve()

<!-- notecardId: 1703175555604 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyResolve**
2. è¯¥æ–¹æ³•**æ¥å—ä¸€ä¸ªå‚æ•° value**
3. åœ¨æ–¹æ³•å†…ï¼šæ ¹æ®å‚æ•° value çš„ç±»å‹ï¼Œè¿”å› Promise å¯¹è±¡
   1. è‹¥ä¸º **Promise å¯¹è±¡**ï¼Œåˆ™ç›´æ¥è¿”å›
   2. è‹¥ä¸º**é Promise å¯¹è±¡**ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œå…¶çŠ¶æ€å€¼ä¸º fulfilledï¼Œç»“æœå€¼ä¸ºè¯¥é Promise å¯¹è±¡

ä»£ç ï¼š

```javascript
Promise.MyPromise = (value) => {
  if (value instanceof Promise) {
    return value;
  }

  return new Promise((resolve, reject) => {
    resolve(value);
  });
};
```

## æ‰‹å†™ Promise.reject()

<!-- notecardId: 1703175555611 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyReject**
2. è¯¥æ–¹æ³•æ¥å—**ä¸€ä¸ªå‚æ•° reason**
3. åœ¨è¯¥æ–¹æ³•å†…ï¼š
   - **ä¸ç®¡ reason ç±»å‹æ˜¯ä»€ä¹ˆ**ï¼Œ**å§‹ç»ˆè¿”å›**ä¸€ä¸ª**æ–°çš„ Promise å¯¹è±¡**ï¼Œå…¶çŠ¶æ€å€¼ä¸º rejectedï¼Œç»“æœå€¼ä¸ºå‚æ•° reason

ä»£ç ï¼š

```javascript
Promise.MyReject = (reason) => {
  return new Promise((resolve, reject) => {
    reject(reason);
  });
};
```

## æ‰‹å†™ Promise.all()

<!-- notecardId: 1703175555617 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyAll**
2. è¯¥æ–¹æ³•**æ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ arr**ï¼Œå¹¶**è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡**ï¼Œåœ¨ Promise å¯¹è±¡å†…ï¼š
   1. **åˆ¤æ–­æ‰€ä¼ å…¥å‚æ•°ç±»å‹**ï¼Œè‹¥ä¸æ˜¯æ•°ç»„ï¼Œåˆ™ç›´æ¥è°ƒç”¨ reject æ–¹æ³•ï¼Œå¹¶ä¼ å…¥è‡ªå®šä¹‰ç±»å‹é”™è¯¯æç¤ºï¼Œå¹¶è¿”å›
   2. è‹¥ä¸ºæ•°ç»„ï¼Œåˆ™**å®šä¹‰ç›¸å…³å˜é‡**ï¼Œåˆ†åˆ«æ˜¯ resolvedCounterã€resolvedValueã€length
      > æ³¨ï¼š
      > resolvedCounter â†’ ç”¨äºå­˜å‚¨æˆåŠŸçŠ¶æ€çš„ Promise å¯¹è±¡æ•°é‡
      > resolvedValue â†’ æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡çš„ç»“æœå€¼
      > length â†’ ç”¨äºå­˜å‚¨æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„çš„é•¿åº¦
   3. **éå†**æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„ï¼Œåœ¨å¾ªç¯ä½“å†…ï¼š
      1. è°ƒç”¨ **Promise.resolve** æ–¹æ³•å°†æ•°ç»„ä¸­é Promise å¯¹è±¡çš„å…ƒç´ å¤„ç†æˆ Promise å¯¹è±¡
      2. é“¾å¼è°ƒç”¨ then æ–¹æ³•ï¼Œå¤„ç†æˆåŠŸçš„æƒ…å†µï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
         1. **å­˜å‚¨**æˆåŠŸçŠ¶æ€çš„ Promise å¯¹è±¡çš„**ç»“æœå€¼**
         2. **ç´¯åŠ **å½“å‰æˆåŠŸçŠ¶æ€çš„ promise å¯¹è±¡**æ•°é‡**
         3. å½“æ‰€è®°å½•çš„æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡**æ•°é‡ç­‰äº**æ‰€ä¼ å…¥å‚æ•°æ•°ç»„çš„**é•¿åº¦**ï¼Œå°±**è°ƒç”¨ resolve æ–¹æ³•**ï¼Œå¹¶**ä¼ å…¥**æ‰€å­˜å‚¨çš„æ‰€æœ‰**æˆåŠŸçŠ¶æ€** Promise å¯¹è±¡çš„**ç»“æœå€¼**
      3. é“¾å¼è°ƒç”¨ catch æ–¹æ³•ï¼Œå¤„ç†å¤±è´¥çš„æƒ…å†µï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
         - **è°ƒç”¨ reject æ–¹æ³•**ï¼Œå¹¶ä¼ å…¥å¤±è´¥çŠ¶æ€çš„ Promise å¯¹è±¡çš„ç»“æœå€¼

ä»£ç ï¼š

```javascript
Promise.MyAll = (arr) => {
  return new Promise((resolve, reject) => {
    if (!Array.isArray(arr)) {
      return reject(new TypeError('argument must be Array'));
    }

    let resolvedCounter = 0;
    const resolvedValue = [];
    const length = arr.length;

    arr.forEach((item) => {
      Promise.resolve(item)
        .then((data) => {
          resolvedValue.push(data);
          resolvedCounter++;
          if (resolvedCounter === length) {
            resolve(resolvedValue);
          }
        })
        .catch((error) => {
          reject(error);
        });
    });
  });
};
```

## æ‰‹å†™ Promise.race()

<!-- notecardId: 1703258725510 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. åœ¨æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyRace**
2. è¯¥æ–¹æ³•**æ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ arr**
3. è¯¥æ–¹æ³•**è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡**ï¼Œåœ¨è¯¥å¯¹è±¡å†…ï¼š
   1. **åˆ¤æ–­æ‰€ä¼ å…¥å‚æ•°çš„ç±»å‹**
      - è‹¥ä¸æ˜¯æ•°ç»„ï¼Œåˆ™ç›´æ¥è°ƒç”¨ reject æ–¹æ³•ï¼Œä¼ å…¥è‡ªå®šä¹‰ç±»å‹é”™è¯¯æç¤ºï¼Œå¹¶è¿”å›
   2. è‹¥ä¸ºæ•°ç»„ï¼Œåˆ™**å®šä¹‰ä¸€ä¸ªçŠ¶æ€æ ‡è®°å˜é‡ isResolved**ï¼Œç”¨äºæ ‡è®°æ˜¯å¦å·²ç»æœ‰æˆåŠŸçš„ Promise å¯¹è±¡
   3. **éå†**æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„ï¼Œåœ¨å¾ªç¯ä½“å†…ï¼š
      1. è°ƒç”¨ **Promise.resolve** æ–¹æ³•å°†æ•°ç»„ä¸­é Promise å¯¹è±¡çš„å…ƒç´ å¤„ç†æˆ Promise å¯¹è±¡
      2. é“¾å¼è°ƒç”¨ then æ–¹æ³•ï¼Œå¤„ç†æˆåŠŸçš„æƒ…å†µï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
         - åˆ¤æ–­æ˜¯å¦æœ‰æˆåŠŸçš„ Promise å¯¹è±¡
           - **è‹¥è¿˜æ²¡æœ‰æˆåŠŸçš„ Promise å¯¹è±¡ï¼ˆå³ isResolved ä¸º falseï¼‰**ï¼Œåˆ™**è°ƒç”¨ resolve æ–¹æ³•**ï¼Œå¹¶ä¼ å…¥æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡çš„ç»“æœå€¼ï¼Œå¹¶**å°†çŠ¶æ€æ ‡è®°ä¸º true**
             > æ³¨ï¼šä¹‹æ‰€ä»¥ä½¿ç”¨æ ‡è®°ï¼Œæ˜¯ä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œå› ä¸º race æ–¹æ³•**åªè¦ç¬¬ä¸€ä¸ªçŠ¶æ€å‘ç”Ÿæ”¹å˜çš„ Promise å¯¹è±¡ï¼Œä¹‹åçš„ Promise å¯¹è±¡æ²¡å¿…è¦å¤„ç†**
      3. é“¾å¼è°ƒç”¨ catch æ–¹æ³•ï¼Œå¤„ç†å¤±è´¥çš„æƒ…å†µï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
         - **è°ƒç”¨ reject æ–¹æ³•**ï¼Œå¹¶ä¼ å…¥å¤±è´¥çŠ¶æ€çš„ Promise å¯¹è±¡çš„ç»“æœå€¼

ä»£ç ï¼š

```javascript
Promise.MyRace = (arr) => {
  return new Promise((resolve, reject) => {
    if (!Array.isArray(arr)) {
      return reject(new TypeError('arguments must be array'));
    }

    let isResolved = false;

    arr.forEach((item) => {
      Promise.resolve(item)
        .then((value) => {
          if (!isResolved) {
            resolve(value);
            isResolved = true;
          }
        })
        .catch((error) => {
          reject(error);
        });
    });
  });
};
```

## ç¼–å†™ä¸€ä¸ªé€šç”¨çš„äº‹ä»¶ç›‘å¬å‡½æ•°

<!-- notecardId: 1703347511961 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å£°æ˜ä¸€ä¸ªåä¸º bindEvent çš„å‡½æ•°
2. è¯¥å‡½æ•°æ¥å—**å››ä¸ªå‚æ•°**ï¼Œåˆ†åˆ«æ˜¯ **element, type, selector, fn**
   æ³¨ï¼š
   element ç”¨äºæ¥å—éœ€è¦ç»‘å®šçš„å…ƒç´ 
   type ç”¨äºæ¥å—è¦ç»‘å®šçš„äº‹ä»¶ç±»å‹
   selector ç”¨äºæ¥å—ä¸€ä¸ªæŒ‡å®šçš„é€‰æ‹©å™¨ï¼Œä»¥ä¾¿åœ¨äº‹ä»¶ä»£ç†ä¸­**ç›‘å¬ä¸ä¹‹åŒ¹é…çš„å­å…ƒç´ **
   fn ç”¨äºæ¥å—ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°
3. åœ¨è¯¥å‡½æ•°å†…ï¼š
   1. **åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¼ å…¥ selector å‚æ•°**
      - è‹¥æ²¡æœ‰ä¼ å…¥ selector å‚æ•°ï¼ˆå³ fn ä¸º nullï¼‰ï¼Œåˆ™å°† selector èµ‹å€¼ç»™ fnï¼Œå¹¶æŠŠ selector è®¾ç½®ä¸º null
   2. **è°ƒç”¨ addEventListener æ–¹æ³•è¿›è¡Œäº‹ä»¶ç»‘å®š**ï¼Œåœ¨å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å†…ï¼š
      1. **è·å–è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œå¹¶å­˜å‚¨**
      2. **åˆ¤æ–­æ˜¯ä»£ç†ç»‘å®šè¿˜æ˜¯æ™®é€šç»‘å®š**
         - è‹¥ä¸ºä»£ç†ç»‘å®šï¼ˆå³ selector æœ‰å€¼ï¼‰ï¼Œåˆ™**åˆ¤æ–­è§¦å‘äº‹ä»¶çš„å…ƒç´ æ˜¯å¦ä¸æŒ‡å®šçš„é€‰æ‹©å™¨åŒ¹é…**
           - è‹¥åŒ¹é…ï¼Œåˆ™ä½¿ç”¨ call æ–¹æ³•è°ƒç”¨ fnï¼Œå¹¶å°†**è§¦å‘äº‹ä»¶å…ƒç´ **å’Œ**äº‹ä»¶å¯¹è±¡ event** ä½œä¸ºå‚æ•°ä¼ å…¥
         - è‹¥ä¸ºæ™®é€šç»‘å®šï¼ˆå³ selector æ— å€¼ï¼‰ï¼Œåˆ™ä½¿ç”¨ call æ–¹æ³•è°ƒç”¨ fnï¼Œå¹¶å°†è§¦å‘äº‹ä»¶å…ƒç´ å’Œäº‹ä»¶å¯¹è±¡ event ä½œä¸ºå‚æ•°ä¼ å…¥

ä»£ç ï¼š

```javascript
function bindEvent(element, type, selector, fn) {
  if (fn == null) {
    fn = selector;
    selector = null;
  }

  element.addEventListener(type, (event) => {
    const target = event.target;

    if (selector) {
      if (target.matches(selector)) {
        fn.call(target, event);
      }
    } else {
      fn.call(target, event);
    }
  });
}
```

## æ‰‹å†™ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘èµ· get è¯·æ±‚

<!-- notecardId: 1703522110467 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **å®ä¾‹åŒ–ä¸€ä¸ª XMLHttpRequest å¯¹è±¡**
2. **è°ƒç”¨ XMLHttpRequest å¯¹è±¡ open() æ–¹æ³•**ï¼Œå¹¶ä¼ å…¥è¯·æ±‚æ–¹æ³• GET å’Œè¯·æ±‚åœ°å€ä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°è¯·æ±‚
3. **ç›‘å¬ onreadystatechange äº‹ä»¶**ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°å†…ï¼š
   1. **åˆ¤æ–­æ­¤æ¬¡è¯·æ±‚æ“ä½œæ˜¯å¦å®Œæˆ**
      - è‹¥å·²å®Œæˆï¼ˆå³æ‰€è¿”å›çš„è¯·æ±‚çŠ¶æ€å€¼ä¸º 4ï¼‰ï¼Œåˆ™**å†åˆ¤æ–­æ˜¯å¦æ­¤æ¬¡è¯·æ±‚æ˜¯å¦æˆåŠŸ**
        - è‹¥æˆåŠŸï¼ˆå³å“åº”çŠ¶æ€ç ä¸º 200ï¼‰ï¼Œåˆ™å¯¹å“åº”æ•°æ®è¿›è¡Œç›¸å…³å¤„ç†
4. **è°ƒç”¨ XMLHttpRequest å¯¹è±¡ send() æ–¹æ³•**ï¼Œå‘èµ· HTTP è¯·æ±‚

```javascript
const xhr = new XMLHttpRequest();

xhr.open('GET', 'http://www.example.com/api/');

xhr.onreadystatechange = function () {
  if (xhr.readyState === 4) {
    if (xhr.status === 200) {
      console.log(xhr.responseText);
    }
  }
};

xhr.send(null);
```

## æ‰‹å†™ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘èµ· post è¯·æ±‚

<!-- notecardId: 1703522110477 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **å®ä¾‹åŒ–ä¸€ä¸ª XMLHttpRequest å¯¹è±¡**
2. **è°ƒç”¨ XMLHttpRequest å¯¹è±¡ open() æ–¹æ³•**ï¼Œå¹¶ä¼ å…¥è¯·æ±‚æ–¹æ³• POST å’Œè¯·æ±‚åœ°å€ä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°è¯·æ±‚
3. è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šè¯·æ±‚ä½“çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ï¼šJSON æ•°æ®ç±»å‹
4. **ç›‘å¬ onreadystatechange äº‹ä»¶**ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°å†…ï¼š
   1. **åˆ¤æ–­æ­¤æ¬¡è¯·æ±‚æ“ä½œæ˜¯å¦å®Œæˆ**
      - è‹¥å·²å®Œæˆï¼ˆå³æ‰€è¿”å›çš„è¯·æ±‚çŠ¶æ€å€¼ä¸º 4ï¼‰ï¼Œåˆ™**å†åˆ¤æ–­æ˜¯å¦æ­¤æ¬¡è¯·æ±‚æ˜¯å¦æˆåŠŸ**
        - è‹¥æˆåŠŸï¼ˆå³å“åº”çŠ¶æ€ç ä¸º 200ï¼‰ï¼Œåˆ™å¯¹å“åº”æ•°æ®è¿›è¡Œç›¸å…³å¤„ç†
5. **è°ƒç”¨ XMLHttpRequest å¯¹è±¡ send() æ–¹æ³•**ï¼Œå°†è¯·æ±‚ä½“æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¹¶ä¼ å…¥ï¼Œå‘èµ· HTTP è¯·æ±‚

```javascript
const xhr = new XMLHttpRequest();

xhr.open('POST', 'http://www.example.com/api/');

xhr.onreadystatechange = function () {
  if (xhr.readyState === 4) {
    if (xhr.status === 200) {
      console.log(xhr.responseText);
    }
  }
};

xhr.setRequestHeader('Content-Type', 'application/json');

const data = {
  userName: 'zhangsan',
  password: 'xxx',
};

xhr.send(JSON.stringify(data));
```

## æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„ ajax

<!-- notecardId: 1703522110481 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å£°æ˜ä¸€ä¸ªåä¸º myAjax çš„å‡½æ•°
2. è¯¥å‡½æ•°**æ¥å—ä¸€ä¸ªå¯¹è±¡å‚æ•° options**
3. **å®ä¾‹åŒ–ä¸€ä¸ª XMLHttpRequest å¯¹è±¡**
4. **ç›‘å¬ onreadystatechange äº‹ä»¶**ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°å†…ï¼š
   1. **åˆ¤æ–­æ­¤æ¬¡è¯·æ±‚æ“ä½œæ˜¯å¦å®Œæˆ**
      - è‹¥å·²å®Œæˆï¼ˆå³æ‰€è¿”å›çš„è¯·æ±‚çŠ¶æ€å€¼ä¸º 4ï¼‰ï¼Œåˆ™**å†åˆ¤æ–­æ˜¯å¦æ­¤æ¬¡è¯·æ±‚æ˜¯å¦æˆåŠŸ**
        - è‹¥æˆåŠŸï¼ˆå³å“åº”çŠ¶æ€ç ä¸º 200ï¼‰ï¼Œåˆ™è°ƒç”¨æ‰€ä¼ å…¥å¯¹è±¡å‚æ•° options çš„ success æ–¹æ³•å¯¹å“åº”æ•°æ®è¿›è¡Œç›¸å…³å¤„ç†
5. **åˆ¤æ–­è¯·æ±‚æ–¹æ³•**
   - è‹¥ä¸º GET è¯·æ±‚æˆ–è€…æœªè®¾ç½®ï¼Œåˆ™
     1. è°ƒç”¨ XMLHttpRequest å¯¹è±¡ open() æ–¹æ³•ï¼Œå¹¶ä¼ å…¥è¯·æ±‚æ–¹æ³• POST å’Œè¯·æ±‚åœ°å€ä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°è¯·æ±‚
     2. è°ƒç”¨ XMLHttpRequest å¯¹è±¡ send() æ–¹æ³•ï¼Œå‘èµ· HTTP è¯·æ±‚
   - è‹¥ä¸º POST è¯·æ±‚ï¼Œåˆ™
     1. è°ƒç”¨ XMLHttpRequest å¯¹è±¡ open() æ–¹æ³•ï¼Œå¹¶ä¼ å…¥è¯·æ±‚æ–¹æ³• POST å’Œè¯·æ±‚åœ°å€ä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°è¯·æ±‚
     2. **è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šè¯·æ±‚ä½“çš„æ•°æ®ç±»å‹**ï¼Œæ¯”å¦‚ï¼šJSON æ•°æ®ç±»å‹
     3. è°ƒç”¨ XMLHttpRequest å¯¹è±¡ send() æ–¹æ³•ï¼Œï¼Œ**å°†è¯·æ±‚ä½“æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²**ï¼Œå¹¶ä¼ å…¥ï¼Œå‘èµ· HTTP è¯·æ±‚

```javascript
function myAjax(options) {
  const xhr = new XMLHttpRequest();

  xhr.onreadystatechange = function () {
    if (this.readyState === 4) {
      if (this.status === 200) {
        const result = JSON.parse(this.responseText);
        options.success(result);
      }
    }
  };

  if (options.method.toUpperCase() === 'GET' || options.method == null) {
    xhr.open('GET', options.url, true);
    xhr.send(null);
  }

  if (options.method.toUpperCase() === 'POST') {
    xhr.open('POST', options.url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(JSON.stringify(options.data));
  }
}

// å‚æ•°æ ¼å¼
ajax({
  method: 'GET',
  url: 'http://example.com/api',
  success: function (response) {
    console.log(response);
  },
});
```

## æ‰‹å†™é˜²æŠ– debounce

<!-- notecardId: 1704297474177 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

### æ€è·¯

1. å£°æ˜ä¸€ä¸ªåä¸º debounce çš„å‡½æ•°
2. è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šfnï¼ˆå‡½æ•°ï¼‰ã€delayï¼ˆå®šæ—¶æ—¶é—´ï¼‰
3. è¯¥å‡½æ•°å†…ï¼š

   1. **å£°æ˜ä¸€ä¸ªå˜é‡ timerï¼Œå¹¶åˆå§‹åŒ–ä¸º null**ï¼Œç”¨äºå­˜å‚¨å®šæ—¶å™¨ç¼–å·
      > æ³¨ï¼šå®šæ—¶å™¨ç¼–å·å°±æ˜¯å‡½æ•° setTimeout() çš„è¿”å›å€¼ï¼Œä¸€ä¸ªæ­£æ•´æ•°
   2. è¿”å›æœ‰ä¸€ä¸ªæ–°å‡½æ•°ï¼ˆä½¿ç”¨**éç®­å¤´å‡½æ•°**ï¼‰ï¼Œåœ¨è¯¥æ–°å‡½æ•°å†…ï¼š

      1. **åˆ¤æ–­æ˜¯å¦å·²æœ‰å®šæ—¶å™¨**
         - è‹¥æœ‰ï¼ˆå³ timer æœ‰å€¼ï¼‰ï¼Œåˆ™æ¸…é™¤å®šæ—¶å™¨
           > æ³¨ï¼šè°ƒç”¨ clearTimeout(timer) åªæ˜¯å–æ¶ˆè®¡æ—¶å™¨ï¼Œå¹¶ä¸ä¼šæ”¹å˜ timer å˜é‡æœ¬èº«çš„å€¼
      2. **è‹¥æ²¡æœ‰ï¼Œåˆ™è®¾ç½®å®šæ—¶å™¨**ï¼Œä¼ å…¥å‚æ•° delayï¼Œå¹¶åœ¨å…¶å›è°ƒå‡½æ•°ï¼ˆä½¿ç”¨**ç®­å¤´å‡½æ•°**ï¼‰å†…ï¼š

         1. **ä½¿ç”¨ apply æ–¹æ³•è°ƒç”¨ fnï¼Œå¹¶ä¼ å…¥ this å’Œ arguments**

            > æ³¨ï¼š
            >
            > 1. ç®­å¤´å‡½æ•°ä¸­ this ç»§æ‰¿ä¸Šä¸€çº§ä½œç”¨åŸŸï¼ˆè¿”å›çš„æ–°å‡½æ•°ï¼‰å†…çš„ thisï¼Œè€Œè¿”å›çš„æ–°å‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œæ‰€ä»¥ **this æŒ‡å‘äº‹ä»¶æº**
            > 2. ç®­å¤´å‡½æ•°æ²¡æœ‰ argumentsï¼Œæ‰€ä»¥ä¼šæ²¿ç€ä½œç”¨åŸŸé“¾å¾€ä¸ŠæŸ¥æ‰¾ï¼Œä½¿ç”¨è¿”å›æ–°å‡½æ•°çš„ **arguments**ï¼Œ**å…¶å€¼ä¸º**è§¦å‘äº‹ä»¶æ—¶ï¼Œæ‰€ç”Ÿæˆçš„**äº‹ä»¶å¯¹è±¡ event**

         2. **å°† timer è®¾ç½®ä¸º null**
            > æ³¨ï¼šè‹¥ä¸è®¾ç½®ä¸º nullï¼Œåˆ™ä»ç¬¬äºŒæ¬¡è§¦å‘äº‹ä»¶å¼€å§‹ï¼Œtimer ä¼šä¸€ç›´æœ‰å€¼ï¼Œå¯¼è‡´ if (timer) å½¢åŒè™šè®¾

      3. **å°†å®šæ—¶å™¨ setTimeout() çš„è¿”å›å€¼å­˜å‚¨åœ¨ timer ä¸­**

### ä»£ç 

```javascript
function debounce(fn, delay) {
  let timer = null;

  return function () {
    if (timer) {
      clearTimeout(timer);
    }

    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}

/* æµ‹è¯•ç”¨ä¾‹ */
const input = document.getElementById('input');

input.addEventListener(
  'keyup',
  debounce(function () {
    console.log(input.value);
  }, 500)
);
```

## æ‰‹å†™èŠ‚æµ throttle

<!-- notecardId: 1704297474186 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

### æ€è·¯

1. å£°æ˜ä¸€ä¸ªåä¸º throttle çš„å‡½æ•°
2. è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šfnï¼ˆå‡½æ•°ï¼‰ã€delayï¼ˆå®šæ—¶æ—¶é—´ï¼‰
3. è¯¥å‡½æ•°å†…ï¼š

   1. **å£°æ˜ä¸€ä¸ªå˜é‡ timerï¼Œå¹¶åˆå§‹åŒ–ä¸º null**ï¼Œç”¨äºå­˜å‚¨å®šæ—¶å™¨ç¼–å·
      > æ³¨ï¼šå®šæ—¶å™¨ç¼–å·å°±æ˜¯å‡½æ•° setTimeout() çš„è¿”å›å€¼ï¼Œä¸€ä¸ªæ­£æ•´æ•°
   2. è¿”å›æœ‰ä¸€ä¸ªæ–°å‡½æ•°ï¼ˆä½¿ç”¨**éç®­å¤´å‡½æ•°**ï¼‰ï¼Œåœ¨è¯¥æ–°å‡½æ•°å†…ï¼š

      1. **åˆ¤æ–­æ˜¯å¦å·²æœ‰å®šæ—¶å™¨**
         - è‹¥æœ‰ï¼ˆå³ timer æœ‰å€¼ï¼‰ï¼Œåˆ™**ç›´æ¥è¿”å›**ï¼Œä¸å¤„ç†
      2. **è‹¥æ²¡æœ‰ï¼Œåˆ™è®¾ç½®å®šæ—¶å™¨**ï¼Œä¼ å…¥å‚æ•° delayï¼Œå¹¶åœ¨å…¶å›è°ƒå‡½æ•°ï¼ˆä½¿ç”¨**ç®­å¤´å‡½æ•°**ï¼‰å†…ï¼š

         1. **ä½¿ç”¨ apply æ–¹æ³•è°ƒç”¨ fnï¼Œå¹¶ä¼ å…¥ this å’Œ arguments**

            > æ³¨ï¼š
            >
            > 1. ç®­å¤´å‡½æ•°ä¸­ this ç»§æ‰¿ä¸Šä¸€çº§ä½œç”¨åŸŸï¼ˆè¿”å›çš„æ–°å‡½æ•°ï¼‰å†…çš„ thisï¼Œè€Œè¿”å›çš„æ–°å‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œæ‰€ä»¥ **this æŒ‡å‘äº‹ä»¶æº**
            > 2. ç®­å¤´å‡½æ•°æ²¡æœ‰ argumentsï¼Œæ‰€ä»¥ä¼šæ²¿ç€ä½œç”¨åŸŸé“¾å¾€ä¸ŠæŸ¥æ‰¾ï¼Œä½¿ç”¨è¿”å›æ–°å‡½æ•°çš„ **arguments**ï¼Œ**å…¶å€¼ä¸º**è§¦å‘äº‹ä»¶æ—¶ï¼Œæ‰€ç”Ÿæˆçš„**äº‹ä»¶å¯¹è±¡ event**

         2. **å°† timer è®¾ç½®ä¸º null**
            > æ³¨ï¼šè‹¥ä¸è®¾ç½®ä¸º nullï¼Œåˆ™ä»ç¬¬äºŒæ¬¡è§¦å‘äº‹ä»¶å¼€å§‹ï¼Œtimer ä¼šä¸€ç›´æœ‰å€¼ï¼Œå¯¼è‡´ if (timer) å½¢åŒè™šè®¾

   3. **å°†å®šæ—¶å™¨ setTimeout() çš„è¿”å›å€¼å­˜å‚¨åœ¨ timer ä¸­**

### ä»£ç 

```javascript
function throttle(fn, delay) {
  let timer = null;

  return function () {
    if (timer) return;

    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}

/* æµ‹è¯•ç”¨ä¾‹ */
const div1 = document.getElementById('div1');

div1.addEventListener(
  'drag',
  throttle(function (event) {
    console.log(event.offsetX, event.offsetY);
  }, 100)
);
```

## æ‰‹å†™æ·±åº¦æ¯”è¾ƒï¼Œæ¨¡æ‹Ÿ lodash åº“çš„ isEqual æ–¹æ³•

<!-- notecardId: 1704382876481 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

### æ€è·¯

1. å£°æ˜ä¸€ä¸ªåä¸º isEqual å‡½æ•°
2. è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šobj1ã€obj2
3. åœ¨å‡½æ•°å†…ï¼š
   1. **åˆ¤æ–­æ‰€ä¼ å…¥å‚æ•°çš„ç±»å‹**
      1. è‹¥ä¼ å…¥çš„**ä»»æ„ä¸€ä¸ª**å‚æ•°**ä¸æ˜¯å¯¹è±¡æˆ–è€…æ˜¯ null**ï¼Œåˆ™ç›´æ¥æ¯”è¾ƒ
      2. è‹¥ä¼ å…¥çš„å‚æ•°**å¼•ç”¨åœ°å€ä¸€æ ·**ï¼Œåˆ™ç›´æ¥è¿”å› true
   2. **åˆ†åˆ«è·å–å¯¹è±¡ obj1 å’Œ obj2 çš„æ‰€æœ‰é”®**
      > æ³¨ï¼šObject.keys() æ–¹æ³•è¿”å›ä¸€ä¸ª**åŒ…å«ç»™å®šå¯¹è±¡æ‰€æœ‰ã€Œé”®/ç´¢å¼•ã€çš„æ•°ç»„**
   3. **åˆ¤æ–­é”®æ•°é‡æ˜¯å¦ç›¸ç­‰**
      1. è‹¥é”®æ•°é‡ä¸ç›¸ç­‰ï¼Œåˆ™æ²¡å¿…è¦å†æ¯”è¾ƒï¼Œç›´æ¥è¿”å› false
   4. **éå†åŒ…å«å¯¹è±¡ obj1 æ‰€æœ‰é”®çš„æ•°ç»„**ï¼Œåœ¨å¾ªç¯ä½“å†…ï¼š
      1. **åˆ¤æ–­ obj2 å’Œ obj1 çš„å½“å‰é”®å’Œå€¼**
         1. è‹¥ obj2 å†…æ²¡æœ‰ obj1 çš„å½“å‰é”®ï¼Œæˆ–è€…æœ‰ obj1 çš„å½“å‰é”®ï¼Œä½†æ˜¯**é€’å½’è°ƒç”¨ isEqual å‡½æ•°æ¯”è¾ƒå½“å‰å€¼**çš„ç»“æœä¸º falseï¼Œåˆ™ç›´æ¥è¿”å› false
   5. **è¿”å› true**
      > æ³¨ï¼šæ‰§è¡Œåˆ°è¿™æ­¥ï¼Œè¯´æ˜æ‰§è¡Œä»¥ä¸Šä»£ç æœªè§¦å‘æ¡ä»¶ï¼Œå³æœª return false

### ä»£ç 

```javascript
function isEqual(obj1, obj2) {
  if (
    typeof obj1 !== 'object' ||
    typeof obj2 !== 'object' ||
    obj1 == null ||
    obj2 == null
  ) {
    return obj1 === obj2;
  }

  if (obj1 === obj2) {
    return true;
  }

  const obj1Keys = Object.keys(obj1);
  const obj2Keys = Object.keys(obj2);

  if (obj1Keys.length !== obj2Keys.length) {
    return false;
  }

  for (const key of obj1Keys) {
    if (!obj2Keys.includes(key) || !isEqual(obj1[key], obj2[key])) {
      return false;
    }
  }

  return true;
}
```
