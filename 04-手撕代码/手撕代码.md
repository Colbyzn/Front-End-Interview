# Front-End-Interview::04-æ‰‹æ’•ä»£ç 

## æ‰‹å†™æ·±æ‹·è´

<!-- notecardId: 1702310914312 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **åˆ¤æ–­è¦æ‹·è´çš„å¯¹è±¡ç±»å‹**ï¼šè‹¥ä¸ºå€¼ç±»å‹æˆ–è€…å‡½æ•°ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å€¼
2. **å£°æ˜å˜é‡**ï¼šç”¨äºå­˜å‚¨æ‰€æ‹·è´å¯¹è±¡
3. **å¤„ç†æ•°ç»„**ï¼šè‹¥ä¸ºæ•°ç»„ï¼Œåˆ™åˆå§‹åŒ–å˜é‡ä¸º []ï¼Œç„¶åéå†æ•°ç»„ï¼Œå¯¹æ•°ç»„å†…çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ deepClone å‡½æ•°ï¼ˆå³**é€’å½’è°ƒç”¨**ï¼‰
4. **å¤„ç†å¯¹è±¡**ï¼šè‹¥ä¸ºå¯¹è±¡ï¼Œåˆ™åˆå§‹åŒ–å˜é‡ä¸º {}ï¼Œç„¶åéå†å¯¹è±¡ï¼Œå¯¹å¯¹è±¡å†…çš„æ¯ä¸ª**è‡ªæœ‰å±æ€§**ï¼ˆå³éåŸå‹ä¸Šçš„å±æ€§ï¼‰è°ƒç”¨ deepClone å‡½æ•°ï¼ˆå³**é€’å½’è°ƒç”¨**ï¼‰
5. **è¿”å›ç»“æœ**

ä»£ç ï¼š

```javascript
function deepclone(obj) {
  if (typeof obj !== "object" || obj == null) return obj;

  let result;

  if (obj instanceof Array) {
    result = [];
    for (let i = 0, len = obj.length; i < len; i++) {
      result[i] = deepclone(obj[i]);
    }
  }

  if (obj instanceof Object) {
    result = {};
    for (let key in obj) {
      if (obj.hasOwnProperty(key)) {
        result[key] = deepclone(obj[key]);
      }
    }
  }

  return result;
}
```

## æ‰‹å†™ call å‡½æ•°

<!-- notecardId: 1702742490459 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myCall æ–¹æ³•**
   > æ³¨ï¼šè¿™æ ·æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™å–å€¼ä¸º Window å¯¹è±¡
3. **è·å–å‰©ä½™å‚æ•°**ï¼ˆé™¤äº†ç¬¬ä¸€é¡¹ä¹‹å¤–çš„å‚æ•°ï¼‰
4. **å°†è°ƒç”¨ myCall æ–¹æ³•çš„å‡½æ•°ï¼ˆå³ thisï¼‰æ·»åŠ åˆ°æ‰€ä¼ å…¥çš„ this å¯¹è±¡çš„ fn å±æ€§ä¸Š**
5. **ä½¿ç”¨æ‰€ä¼ å…¥çš„ this å¯¹è±¡æ¥è°ƒç”¨ fn å‡½æ•°**ï¼Œå¹¶ä¼ å…¥å‰©ä½™å‚æ•°
   > æ³¨ï¼šè¿™æ ·å‡½æ•° fn ä¸­çš„ this å°±ä¼šæŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œå³æ‰€ä¼ å…¥çš„ this å¯¹è±¡
6. **åˆ é™¤æ–°æ·»åŠ çš„ fn å±æ€§**
   > æ³¨ï¼šé¿å…æ±¡æŸ“æ‰€ä¼ å…¥çš„ this å¯¹è±¡
7. **è¿”å›**å‡½æ•°è°ƒç”¨åçš„ç»“æœ

ä»£ç ï¼š

```javascript
Function.prototype.myCall = function (context) {
  context = context || window;

  const args = [...arguments].slice(1);

  context.fn = this;

  const result = context.fn(...args);

  delete context.fn;

  return result;
};
```

> æ³¨ï¼šå½“**å®å‚ä¸ªæ•°å¤šäºå½¢å‚**æ—¶ï¼Œå½¢å‚ context **åªä¼šè·å–æ‰€ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå®å‚**ï¼Œå…¶ä½™çš„å®å‚ä¼šå¿½ç•¥

## æ‰‹å†™ apply å‡½æ•°

<!-- notecardId: 1702742490463 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myApply æ–¹æ³•**
   > æ³¨ï¼šè¿™æ ·æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**å’Œ**å‚æ•°æ•°ç»„**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™ this å¯¹è±¡ä¸º Window å¯¹è±¡ï¼Œå‚æ•°æ•°ç»„ä¸º []
3. **å°†è°ƒç”¨ myApply æ–¹æ³•çš„å‡½æ•°ï¼ˆå³ thisï¼‰æ·»åŠ åˆ°æ‰€ä¼ å…¥çš„ this å¯¹è±¡çš„ fn å±æ€§ä¸Š**
4. **ä½¿ç”¨æ‰€ä¼ å…¥çš„ this å¯¹è±¡æ¥è°ƒç”¨ fn å‡½æ•°**ï¼Œå¹¶ä¼ å…¥å‰©ä½™å‚æ•°
   > æ³¨ï¼šè¿™æ ·å‡½æ•° fn ä¸­çš„ this å°±ä¼šæŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œå³æ‰€ä¼ å…¥çš„ this å¯¹è±¡
5. **åˆ é™¤æ–°æ·»åŠ çš„ fn å±æ€§**
   > æ³¨ï¼šé¿å…æ±¡æŸ“æ‰€ä¼ å…¥çš„ this å¯¹è±¡
6. **è¿”å›**å‡½æ•°è°ƒç”¨åçš„ç»“æœ

ä»£ç ï¼š

```javascript
Function.prototype.myApply = function (context, argsArr) {
  context = context || window;
  argsArr = argsArr || [];

  context.fn = this;

  const result = context.fn(...argsArr);

  delete context.fn;

  return result;
};
```

## æ‰‹å†™ bind å‡½æ•°

<!-- notecardId: 1702742490467 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Function çš„**åŸå‹å¯¹è±¡ä¸Šæ·»åŠ  myBind æ–¹æ³•**
   > æ³¨ï¼šä»¥ä¾¿æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥å…¬ç”¨è¯¥æ–¹æ³•
2. **è·å–æ‰€ä¼ å…¥çš„ this å¯¹è±¡**ï¼šè‹¥æœªä¼ å…¥ï¼Œåˆ™å–å€¼ä¸º Window å¯¹è±¡
3. **è·å–å‰©ä½™å‚æ•°**ï¼ˆé™¤äº†ç¬¬ä¸€é¡¹ä¹‹å¤–çš„å‚æ•°ï¼‰
4. **è·å–è°ƒç”¨ myBind æ–¹æ³•çš„å‡½æ•°**
5. **è¿”å›ä¸€ä¸ªæ–°å‡½æ•°**
6. åœ¨æ–°å‡½æ•°å†…ï¼Œå°†æ‰€ä¼ å…¥çš„ this å¯¹è±¡å’Œå‚æ•°**äº¤ç»™ apply å‡½æ•°æ¥å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†åçš„ç»“æœ**

```javascript
Function.prototype.myBind = function (context) {
  context = context || window;

  const argsArr = [...arguments].slice(1);

  const _this = this;

  return function () {
    return _this.apply(context, argsArr);
  };
};
```

## æ‰‹å†™ Promise åŠ è½½ä¸€å¼ å›¾ç‰‡

<!-- notecardId: 1702829254286 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å®šä¹‰ä¸€ä¸ªæ¥å— url å‚æ•°çš„ loadImage å‡½æ•°ï¼Œå¹¶**è¿”å›ä¸€ä¸ªæ–°çš„ Promise**
2. åœ¨è¿”å›çš„ Promise ä¸­ï¼Œ**åˆ›å»ºä¸€ä¸ª img å…ƒç´ **
3. ä¸º img å…ƒç´ **ç»‘å®š onload äº‹ä»¶**ï¼Œå½“å›¾ç‰‡åŠ è½½æˆåŠŸæ—¶ï¼Œè°ƒç”¨ resolve å‡½æ•°å¹¶ä¼ å…¥ img å…ƒç´ 
4. ä¸º img å…ƒç´ **ç»‘å®š onerror äº‹ä»¶**ï¼Œå½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œè°ƒç”¨ reject å‡½æ•°å¹¶ä¼ å…¥ä¸€ä¸ªåŒ…å«é”™è¯¯æç¤ºçš„ Error å¯¹è±¡
5. å°†ä¼ å…¥çš„ url **èµ‹å€¼**ç»™ img å…ƒç´  src å±æ€§
6. è°ƒç”¨ loadImage å‡½æ•°å¹¶ä¼ å…¥å›¾ç‰‡çš„ url è¿”å› Promise å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„ then æ–¹æ³•æ¥å¤„ç†æˆåŠŸçš„æƒ…å†µï¼Œcatch æ–¹æ³•æ¥å¤„ç†é”™è¯¯çš„æƒ…å†µ

ä»£ç ï¼š

```javascript
function loadImage(url) {
  return new Promise((resolve, reject) => {
    const img = document.createElement("img");

    img.onload = function () {
      resolve(img);
    };

    img.onerror = function () {
      reject(new Error(`å›¾ç‰‡åŠ è½½å¤±è´¥ ${url}`));
    };

    img.src = url;
  });
}

const url =
  "https://foruda.gitee.com/avatar/1677103757503685327/7933519_colbyzn_1597326220.png!avatar200";
loadImage(url)
  .then((img) => {
    document.body.appendChild(img);
  })
  .catch((error) => {
    console.log(error);
  });
```

## æ‰‹å†™ Promise

<!-- notecardId: 1703175555593 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. **ä½¿ç”¨ class å£°æ˜ä¸€ä¸ªåä¸º MyPromise çš„ç±»**
2. åœ¨ç±»ä¸­
   - å®šä¹‰çŠ¶æ€ç®¡ç†çš„ç›¸å…³å±æ€§ï¼Œåˆ†åˆ«æ˜¯ **stateã€valueã€reasonã€onFulfilledCallbackã€onRejectedCallback**
     > æ³¨ï¼š
     > state â†’ å­˜å‚¨å½“å‰ Promise çŠ¶æ€å€¼
     > value â†’ å­˜å‚¨ Promise æˆåŠŸçŠ¶æ€çš„ç»“æœå€¼
     > reason â†’ å­˜å‚¨ Promise å¤±è´¥çŠ¶æ€çš„ç»“æœå€¼
     > onFulfilledCallback â†’ æ•°ç»„ï¼Œå­˜å‚¨ Promise æˆåŠŸçŠ¶æ€ä¸‹è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°
     > onRejectedCallback â†’ æ•°ç»„ï¼Œå­˜å‚¨ Promise å¤±è´¥çŠ¶æ€ä¸‹è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°
3. åœ¨æ„é€ å‡½æ•° constructor å†…ï¼š
   1. **æ¥å—ä¸€ä¸ªå‡½æ•° fn ä½œä¸ºå‚æ•°**
   2. **åœ¨ try catch ä¸­è°ƒç”¨ fn**ï¼ŒåŒæ—¶ä¼ å…¥ä¸¤ä¸ªå‡½æ•°å‚æ•° resolve å’Œ reject
   3. å£°æ˜å‡½æ•° resolveï¼Œåœ¨è¯¥å‡½æ•°å†…ï¼š
      - å½“çŠ¶æ€å€¼ä¸º pending æ—¶ï¼Œä¿®æ”¹çŠ¶æ€å€¼ä¸º fulfilledã€ä¿®æ”¹ç»“æœå€¼ä¸ºæ‰€ä¼ å…¥çš„å€¼ï¼Œä»¥åŠæ‰§è¡Œæ‰€æœ‰æˆåŠŸå›è°ƒå‡½æ•°
   4. å£°æ˜å‡½æ•° rejectï¼Œåœ¨è¯¥å‡½æ•°å†…ï¼š
      - å½“çŠ¶æ€å€¼ä¸º pending æ—¶ï¼Œä¿®æ”¹çŠ¶æ€å€¼ä¸º rejectedã€ä¿®æ”¹ç»“æœå€¼ä¸ºæ‰€ä¼ å…¥çš„å€¼ï¼Œä»¥åŠæ‰§è¡Œæ‰€æœ‰å¤±è´¥å›è°ƒå‡½æ•°
4. å£°æ˜ä¸€ä¸ªå…¬æœ‰æ–¹æ³• thenï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
   1. æ¥å—ä¸¤ä¸ªå¯é€‰å‚æ•° onFulfilled å’Œ onRejected
   2. åˆ¤æ–­ä¸¤ä¸ªå‚æ•°æ˜¯å¦ä¸ºå‡½æ•°ç±»å‹ï¼Œ**è‹¥ä¸æ˜¯ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å‡½æ•°æ›¿æ¢**
   3. è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡å†…ï¼š
      1. **è‹¥çŠ¶æ€å€¼ä¸º fulfilled**ï¼Œåˆ™åœ¨ try catch ä¸­è°ƒç”¨ onFulfilled å‡½æ•°ï¼Œå¹¶ä¼ å…¥å½“å‰ Promise æˆåŠŸçŠ¶æ€çš„ç»“æœå€¼ï¼Œä»¥è·å–è¿”å›å€¼ï¼Œç„¶åè°ƒç”¨ resolve å‡½æ•°ï¼Œå¹¶å°†è¿”å›å€¼ä¼ å…¥ï¼Œä»è€Œä¿®æ”¹æ‰€è¿”å›æ–° Promise å¯¹è±¡çš„çŠ¶æ€å€¼å’Œç»“æœå€¼
      2. **è‹¥çŠ¶æ€å€¼ä¸º rejected**ï¼Œåˆ™åœ¨ try catch ä¸­è°ƒç”¨ onRejectedï¼Œå¹¶ä¼ å…¥å½“å‰ Promise å¤±è´¥çŠ¶æ€çš„ç»“æœå€¼ï¼Œä»¥è·å–è¿”å›å€¼ï¼Œç„¶åè°ƒç”¨ reject å‡½æ•°ï¼Œå¹¶å°†è¿”å›å€¼ä¼ å…¥ï¼Œä»è€Œä¿®æ”¹æ‰€è¿”å›æ–° Promise å¯¹è±¡çš„çŠ¶æ€å€¼å’Œç»“æœå€¼
      3. **è‹¥çŠ¶æ€å€¼ä¸º pending**ï¼Œåˆ™å°†çŠ¶æ€å€¼ä¸º fulfilled å’Œ rejected æ‰€å¯¹åº”çš„æ‰§è¡Œä»£ç åŒ…è£¹åœ¨å‡½æ•°å†…ï¼Œå¹¶æ·»åŠ åˆ°ç›¸åº”çš„å›è°ƒæ•°ç»„ä¸­ï¼Œç­‰å¾…æ‰§è¡Œ
         > æ³¨ï¼šä¸Šè¿°çš„çŠ¶æ€å€¼æŒ‡çš„æ˜¯**è°ƒç”¨ then æ–¹æ³•çš„ Promise å¯¹è±¡çš„çŠ¶æ€å€¼**
5. å®šä¹‰ä¸€ä¸ªå…¬æœ‰æ–¹æ³• catchï¼Œåœ¨è¯¥æ–¹æ³•å†…ï¼š
   1. æ¥å—ä¸€ä¸ªå‚æ•° onRejected
   2. å°†æ‰€ä¼ å…¥çš„å‚æ•° onRejected **äº¤ç»™ then æ–¹æ³•å¤„ç†**ï¼Œå¹¶è¿”å›å¤„ç†åçš„ç»“æœ

ä»£ç ï¼š

```javascript
class MyPromise {
  // å…¬æœ‰å±æ€§
  state = "pending";
  value = undefined;
  reason = undefined;
  onFulfilledCallback = [];
  onRejectedCallback = [];

  // æ„é€ å‡½æ•°
  constructor(fn) {
    const resolve = (value) => {
      if (this.state === "pending") {
        this.state = "fulfilled";
        this.value = value;
        this.onFulfilledCallback.forEach((fn) => fn());
      }
    };

    const reject = (reason) => {
      if (this.state === "pending") {
        this.state = "rejected";
        this.reason = reason;
        this.onRejectedCallback.forEach((fn) => fn());
      }
    };

    try {
      fn(resolve, reject);
    } catch (error) {
      reject(error);
    }
  }

  // then æ–¹æ³•
  then(onFulfilled, onRejected) {
    onFulfilled =
      typeof onFulfilled === "function" ? onFulfilled : (value) => value;
    onRejected =
      typeof onRejected === "function" ? onRejected : (reason) => reason;

    return new MyPromise((resolve, reject) => {
      if (this.state === "fulfilled") {
        try {
          const newValue = onFulfilled(this.value);
          resolve(newValue);
        } catch (error) {
          reject(error);
        }
      }
      if (this.state === "rejected") {
        try {
          const newReason = onRejected(this.reason);
          reject(newReason);
        } catch (error) {
          reject(error);
        }
      }
      if (this.state === "pending") {
        this.onFulfilledCallback.push(() => {
          try {
            const newValue = onFulfilled(this.value);
            resolve(newValue);
          } catch (error) {
            reject(error);
          }
        });
        this.onRejectedCallback.push(() => {
          try {
            const newReason = onRejected(this.reason);
            resolve(newReason);
          } catch (error) {
            reject(error);
          }
        });
      }
    });
  }

  // catch æ–¹æ³•
  catch(onRejected) {
    return this.then(null, onRejected);
  }
}
```

## æ‰‹å†™ Promise.resolve()

<!-- notecardId: 1703175555604 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyResolve**
2. è¯¥æ–¹æ³•**æ¥å—ä¸€ä¸ªå‚æ•° value**
3. åœ¨æ–¹æ³•å†…ï¼šæ ¹æ®å‚æ•° value çš„ç±»å‹ï¼Œè¿”å› Promise å¯¹è±¡
   1. è‹¥ä¸º **Promise å¯¹è±¡**ï¼Œåˆ™ç›´æ¥è¿”å›
   2. è‹¥ä¸º**é Promise å¯¹è±¡**ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œå…¶çŠ¶æ€å€¼ä¸º fulfilledï¼Œç»“æœå€¼ä¸ºè¯¥é Promise å¯¹è±¡

ä»£ç ï¼š

```javascript
Promise.MyPromise = (value) => {
  if (value instanceof Promise) {
    return value;
  }

  return new Promise((resolve, reject) => {
    resolve(value);
  });
};
```

## æ‰‹å†™ Promise.reject()

<!-- notecardId: 1703175555611 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•° Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyReject**
2. è¯¥æ–¹æ³•æ¥å—**ä¸€ä¸ªå‚æ•° reason**
3. åœ¨è¯¥æ–¹æ³•å†…ï¼š
   - **ä¸ç®¡ reason ç±»å‹æ˜¯ä»€ä¹ˆ**ï¼Œ**å§‹ç»ˆè¿”å›**ä¸€ä¸ª**æ–°çš„ Promise å¯¹è±¡**ï¼Œå…¶çŠ¶æ€å€¼ä¸º rejectedï¼Œç»“æœå€¼ä¸ºå‚æ•° reason

ä»£ç ï¼š

```javascript
Promise.MyReject = (reason) => {
  return new Promise((resolve, reject) => {
    reject(reason);
  });
};
```

## æ‰‹å†™ Promise.all()

<!-- notecardId: 1703175555617 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. å¾€æ„é€ å‡½æ•°ä¸Š Promise ä¸Š**æ·»åŠ é™æ€æ–¹æ³• MyAll**
2. è¯¥æ–¹æ³•**æ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ arr**ï¼Œå¹¶**è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡**ï¼Œåœ¨ Promise å¯¹è±¡å†…ï¼š
   1. **åˆ¤æ–­æ‰€ä¼ å…¥å‚æ•°ç±»å‹**ï¼Œè‹¥ä¸æ˜¯æ•°ç»„ï¼Œåˆ™ç›´æ¥è°ƒç”¨ reject æ–¹æ³•ï¼Œå¹¶ä¼ å…¥è‡ªå®šä¹‰ç±»å‹é”™è¯¯æç¤ºï¼Œå¹¶è¿”å›
   2. è‹¥ä¸ºæ•°ç»„ï¼Œåˆ™**å®šä¹‰ç›¸å…³å˜é‡**ï¼Œåˆ†åˆ«æ˜¯ resolvedCounterã€resolvedValueã€length
      > æ³¨ï¼š
      > resolvedCounter â†’ ç”¨äºå­˜å‚¨æˆåŠŸçŠ¶æ€çš„ Promise å¯¹è±¡æ•°é‡
      > resolvedValue â†’ æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡çš„ç»“æœå€¼
      > length â†’ ç”¨äºå­˜å‚¨æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„çš„é•¿åº¦
   3. **éå†**æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„ï¼Œä¸ºæ¯ä¸ªå…ƒç´ **æ·»åŠ  then å’Œ catch æ–¹æ³•**ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µ
      > æ³¨ï¼šä½¿ç”¨ **Promise.resolve()** å°†æ•°ç»„ä¸­é Promise å¯¹è±¡çš„å…ƒç´ å¤„ç†æˆ Promise å¯¹è±¡ï¼Œä»¥ä¾¿å¯ä»¥è°ƒç”¨ then å’Œ catch æ–¹æ³•
   4. åœ¨ then æ–¹æ³•å†…ï¼š
      1. **å­˜å‚¨**æˆåŠŸçŠ¶æ€çš„ Promise å¯¹è±¡çš„**ç»“æœå€¼**
      2. **ç´¯åŠ **å½“å‰æˆåŠŸçŠ¶æ€çš„ promise å¯¹è±¡**æ•°é‡**
      3. å½“æ‰€è®°å½•çš„æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡**æ•°é‡ç­‰äº**æ‰€ä¼ å…¥å‚æ•°æ•°ç»„çš„**é•¿åº¦**ï¼Œå°±**è°ƒç”¨ resolve æ–¹æ³•**ï¼Œå¹¶**ä¼ å…¥**æ‰€å­˜å‚¨çš„æ‰€æœ‰**æˆåŠŸçŠ¶æ€** Promise å¯¹è±¡çš„**ç»“æœå€¼**
   5. åœ¨ catch æ–¹æ³•å†…ï¼š
      - **è°ƒç”¨ reject æ–¹æ³•**ï¼Œå¹¶**ä¼ å…¥å¤±è´¥çŠ¶æ€**çš„ Promise å¯¹è±¡çš„**ç»“æœå€¼**

ä»£ç ï¼š

```javascript
Promise.MyAll = (arr) => {
  return new Promise((resolve, reject) => {
    if (!Array.isArray(arr)) {
      return reject(new TypeError("argument must be Array"));
    }

    let resolvedCounter = 0;
    const resolvedValue = [];
    const length = arr.length;

    arr.forEach((item) => {
      Promise.resolve(item)
        .then((data) => {
          resolvedValue.push(data);
          resolvedCounter++;
          if (resolvedCounter === length) {
            resolve(resolvedValue);
          }
        })
        .catch((error) => {
          reject(error);
        });
    });
  });
};
```

## æ‰‹å†™ Promise.race()

<!-- notecardId: 1703258725510 -->

ğŸ“¢ å‚è€ƒç­”æ¡ˆï¼š

æ€è·¯ï¼š

1. åœ¨æ„é€ å‡½æ•° Promise ä¸Šæ·»åŠ é™æ€æ–¹æ³• MyRace
2. è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ arr
3. è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡å†…ï¼š
   1. åˆ¤æ–­æ‰€ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œè‹¥ä¸æ˜¯æ•°ç»„ï¼Œåˆ™ç›´æ¥è°ƒç”¨ reject æ–¹æ³•ï¼Œä¼ å…¥è‡ªå®šä¹‰ç±»å‹é”™è¯¯æç¤ºï¼Œå¹¶è¿”å›
   2. è‹¥ä¸ºæ•°ç»„ï¼Œåˆ™å®šä¹‰ä¸€ä¸ªçŠ¶æ€æ ‡è®°å˜é‡ isResolvedï¼Œç”¨äºæ ‡è®°æ˜¯å¦å·²ç»æœ‰æˆåŠŸçš„ Promise å¯¹è±¡
   3. éå†æ‰€ä¼ å…¥çš„å‚æ•°æ•°ç»„ï¼Œä¸ºæ¯ä¸ªå…ƒç´ æ·»åŠ  then å’Œ catch æ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µ
      > æ³¨ï¼šä½¿ç”¨ Promise.resolve() å°†æ•°ç»„ä¸­é Promise å¯¹è±¡çš„å…ƒç´ å¤„ç†æˆ Promise å¯¹è±¡ï¼Œä»¥ä¾¿å¯ä»¥è°ƒç”¨ then å’Œ catch æ–¹æ³•
   4. åœ¨ then æ–¹æ³•å†…ï¼š
      - è‹¥è¿˜æ²¡æœ‰æˆåŠŸçš„ Promise å¯¹è±¡ï¼Œåˆ™è°ƒç”¨ resolve æ–¹æ³•ï¼Œå¹¶ä¼ å…¥æˆåŠŸçŠ¶æ€ Promise å¯¹è±¡çš„ç»“æœå€¼ï¼Œå¹¶å°†çŠ¶æ€æ ‡è®°ä¸º true
        > æ³¨ï¼šä¹‹æ‰€ä»¥ä½¿ç”¨æ ‡è®°ï¼Œæ˜¯ä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œå› ä¸º race æ–¹æ³•åªè¦ç¬¬ä¸€ä¸ªçŠ¶æ€å‘ç”Ÿæ”¹å˜çš„ Promise å¯¹è±¡ï¼Œä¹‹åçš„ Promise å¯¹è±¡æ²¡å¿…è¦å¤„ç†
   5. åœ¨ catch æ–¹æ³•å†…ï¼š
      - è°ƒç”¨ reject æ–¹æ³•ï¼Œå¹¶ä¼ å…¥å¤±è´¥çŠ¶æ€çš„ Promise å¯¹è±¡çš„ç»“æœå€¼

ä»£ç ï¼š

```javascript
Promise.MyRace = (arr) => {
  return new Promise((resolve, reject) => {
    if (!Array.isArray(arr)) {
      return reject(new TypeError("arguments must be array"));
    }

    let isResolved = false;

    arr.forEach((item) => {
      Promise.resolve(item)
        .then((value) => {
          if (!isResolved) {
            resolve(value);
            isResolved = true;
          }
        })
        .catch((error) => {
          reject(error);
        });
    });
  });
};
```
